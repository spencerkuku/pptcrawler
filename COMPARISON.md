# PTT çˆ¬èŸ²å·¥å…· - æ–°èˆŠç‰ˆæœ¬æ¯”è¼ƒ

## ðŸ†š æ–°èˆŠç‰ˆæœ¬å°æ¯”

### ðŸ“Š **æž¶æ§‹è¨­è¨ˆ**

| ç‰¹æ€§ | èˆŠç‰ˆ ptt.py | æ–°ç‰ˆ ptt_crawler.py |
|------|-------------|---------------------|
| ç¨‹å¼æž¶æ§‹ | å‡½æ•¸å¼ç¨‹å¼è¨­è¨ˆ | é¡žåˆ¥å°Žå‘è¨­è¨ˆ (OOP) |
| ä»£ç¢¼çµæ§‹ | å–®ä¸€æª”æ¡ˆï¼Œå‡½æ•¸æ··é›œ | æ¨¡çµ„åŒ–ï¼Œè·è²¬åˆ†é›¢ |
| å¯ç¶­è­·æ€§ | é›£ä»¥æ“´å±• | æ˜“æ–¼ç¶­è­·å’Œæ“´å±• |
| æ¸¬è©¦å‹å–„ | é›£ä»¥å–®å…ƒæ¸¬è©¦ | æ”¯æ´å–®å…ƒæ¸¬è©¦ |

### ðŸš€ **åŠŸèƒ½æ¯”è¼ƒ**

| åŠŸèƒ½ | èˆŠç‰ˆ | æ–°ç‰ˆ | æ”¹é€²èªªæ˜Ž |
|------|------|------|----------|
| åŸºæœ¬çˆ¬å– | âœ… | âœ… | æ›´ç©©å®šçš„éŒ¯èª¤è™•ç† |
| é€²åº¦é¡¯ç¤º | âŒ | âœ… | tqdm é€²åº¦æ¢ |
| ä¸¦ç™¼è™•ç† | âŒ | âœ… | å¤šç·šç¨‹æå‡æ•ˆçŽ‡ |
| é…ç½®ç®¡ç† | âŒ | âœ… | YAML é…ç½®æ–‡ä»¶ |
| å‘½ä»¤è¡Œæ”¯æ´ | âŒ | âœ… | argparse æ”¯æ´ |
| è‡ªå‹•é‡è©¦ | âŒ | âœ… | æŒ‡æ•¸é€€é¿é‡è©¦ |
| æ—¥èªŒè¨˜éŒ„ | ç°¡å–® print | âœ… | å®Œæ•´æ—¥èªŒç³»çµ± |
| æ•¸æ“šçµæ§‹ | å­—å…¸ | âœ… | dataclass çµæ§‹åŒ– |
| CSV å°Žå‡º | åŸºæœ¬åŠŸèƒ½ | âœ… | æ›´å®Œæ•´çš„å­—æ®µ |
| éŒ¯èª¤è™•ç† | åŸºæœ¬ try-catch | âœ… | ç´°ç²’åº¦éŒ¯èª¤è™•ç† |

### ðŸŽ¯ **ä½¿ç”¨é«”é©—**

#### èˆŠç‰ˆä½¿ç”¨æ–¹å¼ï¼š
```bash
python ppt.py
# åªèƒ½é€éŽé¸å–®äº’å‹•
```

#### æ–°ç‰ˆä½¿ç”¨æ–¹å¼ï¼š
```bash
# äº’å‹•æ¨¡å¼
python ptt_crawler.py

# å‘½ä»¤è¡Œæ¨¡å¼
python ptt_crawler.py --board Gossiping --pages 38950-38952
python ptt_crawler.py --board Gossiping --search "é—œéµå­—"
python ptt_crawler.py --board Gossiping --article M.1234567890.A.123

# ä½¿ç”¨é…ç½®æ–‡ä»¶
python ptt_crawler.py --config config.yaml
```

### ðŸ“ˆ **æ•ˆèƒ½æå‡**

| æŒ‡æ¨™ | èˆŠç‰ˆ | æ–°ç‰ˆ | æå‡å¹…åº¦ |
|------|------|------|----------|
| çˆ¬å–é€Ÿåº¦ | å–®ç·šç¨‹ | å¤šç·šç¨‹ | 2-4x æå‡ |
| ç©©å®šæ€§ | å®¹æ˜“ä¸­æ–· | è‡ªå‹•é‡è©¦ | é¡¯è‘—æå‡ |
| è¨˜æ†¶é«”ä½¿ç”¨ | è¼ƒé«˜ | å„ªåŒ–éŽ | ç´„ 20% é™ä½Ž |
| éŒ¯èª¤æ¢å¾© | æ‰‹å‹•é‡å•Ÿ | è‡ªå‹•è™•ç† | 100% æ”¹å–„ |

### ðŸ› ï¸ **é–‹ç™¼è€…å‹å–„**

#### èˆŠç‰ˆï¼š
```python
# é›£ä»¥æ“´å±•çš„å‡½æ•¸
def crawl_single_article(board_name, article_id, output_dir="./crawled_data"):
    # å¤§é‡æ··é›œçš„é‚è¼¯
    os.makedirs(output_dir, exist_ok=True)
    session = get_session()
    # ... 200+ è¡Œä»£ç¢¼
```

#### æ–°ç‰ˆï¼š
```python
# æ¸…æ™°çš„é¡žåˆ¥çµæ§‹
class PTTCrawler:
    def __init__(self, config: CrawlConfig):
        self.config = config
        self.session = self._create_session()
        self.logger = self._setup_logger()
    
    def crawl_single_article(self, board_name: str, article_id: str) -> Optional[Article]:
        # æ¸…æ™°çš„è·è²¬åˆ†é›¢
        # é¡žåž‹æç¤º
        # çµæ§‹åŒ–è¿”å›ž
```

### ðŸ“Š **æ•¸æ“šçµæ§‹æ”¹é€²**

#### èˆŠç‰ˆï¼š
```python
# ç„¡çµæ§‹çš„å­—å…¸
{
    'article_title': title,
    'author': author,
    'message_count': {...}
}
```

#### æ–°ç‰ˆï¼š
```python
# çµæ§‹åŒ–çš„ dataclass
@dataclass
class Article:
    board: str
    article_id: str
    title: str
    author: str
    # ... é¡žåž‹å®‰å…¨ï¼ŒIDE å‹å–„
```

### ðŸŽ¨ **ç”¨æˆ¶ç•Œé¢**

#### èˆŠç‰ˆï¼š
```
=== PTT çˆ¬èŸ²å·¥å…· ===
1. æŸ¥çœ‹çœ‹æ¿æœ€æ–°é æ•¸
2. çˆ¬å–æŒ‡å®šé é¢ç¯„åœ
```

#### æ–°ç‰ˆï¼š
```
ðŸš€ PTT çˆ¬èŸ²å·¥å…· - é‡æ–°è¨­è¨ˆç‰ˆ
==================================================
1. ðŸ“Š æŸ¥çœ‹çœ‹æ¿æœ€æ–°é æ•¸å’Œæ–‡ç« é è¦½
2. ðŸ“ çˆ¬å–æŒ‡å®šé é¢ç¯„åœ (å®Œæ•´å…§å®¹)
3. ðŸ“„ çˆ¬å–å–®ç¯‡æ–‡ç« 
4. ðŸ” é—œéµå­—æœå°‹æ–‡ç« 
```

### ðŸ“‹ **é…ç½®èƒ½åŠ›**

#### èˆŠç‰ˆï¼š
- ç¡¬ç·¨ç¢¼è¨­å®š
- ç„¡æ³•è‡ªå®šç¾©åƒæ•¸
- é‡å•Ÿç¨‹å¼æ‰èƒ½ä¿®æ”¹

#### æ–°ç‰ˆï¼š
```yaml
# config.yaml
delay_between_requests: 0.1
delay_between_pages: 0.5
max_workers: 4
max_retries: 3
output_dir: "./crawled_data"
```

### ðŸš¦ **éŒ¯èª¤è™•ç†**

#### èˆŠç‰ˆï¼š
```python
try:
    response = requests.get(url)
    # ç°¡å–®çš„éŒ¯èª¤è™•ç†
except:
    print("éŒ¯èª¤")
    return None
```

#### æ–°ç‰ˆï¼š
```python
def _make_request(self, url: str, retries: int = None) -> Optional[requests.Response]:
    max_retries = retries or self.config.max_retries
    
    for attempt in range(max_retries):
        try:
            response = self.session.get(url, timeout=self.config.timeout)
            response.raise_for_status()
            return response
        except requests.RequestException as e:
            self.logger.warning(f"è«‹æ±‚å¤±æ•— (ç¬¬ {attempt + 1} æ¬¡): {e}")
            if attempt < max_retries - 1:
                time.sleep(2 ** attempt)  # æŒ‡æ•¸é€€é¿
```

## ðŸŽ¯ **ç¸½çµ**

æ–°ç‰ˆ PTT çˆ¬èŸ²å·¥å…·åœ¨ä»¥ä¸‹æ–¹é¢æœ‰é¡¯è‘—æ”¹å–„ï¼š

1. **ðŸ—ï¸ æž¶æ§‹è¨­è¨ˆ**: å¾žå‡½æ•¸å¼æ”¹ç‚ºç‰©ä»¶å°Žå‘ï¼Œæ›´å¥½çš„ç¨‹å¼çµæ§‹
2. **âš¡ æ•ˆèƒ½æå‡**: å¤šç·šç¨‹ä¸¦ç™¼ï¼Œè‡ªå‹•é‡è©¦æ©Ÿåˆ¶
3. **ðŸ› ï¸ é–‹ç™¼é«”é©—**: é¡žåž‹æç¤ºï¼Œæ¨¡çµ„åŒ–è¨­è¨ˆï¼Œæ˜“æ–¼æ¸¬è©¦
4. **ðŸ‘¥ ç”¨æˆ¶é«”é©—**: é€²åº¦æ¢ï¼Œç¾Žè§€ç•Œé¢ï¼Œå‘½ä»¤è¡Œæ”¯æ´
5. **ðŸ”§ å¯é…ç½®æ€§**: YAML é…ç½®ï¼Œéˆæ´»çš„åƒæ•¸èª¿æ•´
6. **ðŸš¨ ç©©å®šæ€§**: å®Œå–„çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒç³»çµ±

æ–°ç‰ˆæœ¬ä¸åƒ…ä¿ç•™äº†åŽŸæœ‰çš„æ‰€æœ‰åŠŸèƒ½ï¼Œé‚„å¤§å¹…æå‡äº†ä½¿ç”¨é«”é©—å’Œé–‹ç™¼ç¶­è­·æ€§ã€‚
